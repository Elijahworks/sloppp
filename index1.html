<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8">
  <title>GPT-4o ××“×‘×¨ ××™×ª×š</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial; direction: rtl; text-align: center; padding: 2rem; }
    button { padding: 1rem 2rem; font-size: 1.2rem; margin-top: 1rem; }
    #output { margin-top: 2rem; font-size: 1.4rem; }
  </style>
</head>
<body>

  <h1>×©×•×—×— ×¢× GPT-4o</h1>
  <button onclick="startListening()">ğŸ¤ ×“×‘×¨ ×¢×›×©×™×•</button>
  <div id="output">...</div>

  <script>
    // ×›××Ÿ ×©××™× ××ª ×ª×’×•×‘×•×ª ×”Ö¾JSON ××ª×•×š ×”×§×•×‘×¥ ×©×œ×š
    const responses = [
      {
        keywords: ["××” ×–×”", "××™×š ×–×” ×¢×•×‘×“", "××” ××ª×” ×¢×•×©×”", "××™ ××ª×”", "××™×š ×§×•×¨××™× ×œ×š", "××™×–×” ×¨×•×‘×•×˜ ××ª×”", "×ª×¡×‘×™×¨", "×ª×¡×‘×™×¨ ×œ×™", "×× ×™ ××¢×•× ×™×™×Ÿ", "××¢× ×™×™×Ÿ ××•×ª×™", "××” ××ª×” ×™×•×“×¢", "××” ××ª×” ×™×›×•×œ", "××” ×”××˜×¨×” ×©×œ×š", "××™×š ××ª×” ×¤×•×¢×œ", "××” ××ª×” ×©×•×•×”", "××” ×”×™×›×•×œ×•×ª ×©×œ×š", "×œ××” ××ª×” ×¤×”", "×œ××” ×›×“××™ ×œ×”×©×ª××©", "×¡×¤×¨ ×¢×œ×™×š", "××” ×”×™×ª×¨×•× ×•×ª ×©×œ×š", "×ª×Ÿ ××™×“×¢", "××™×“×¢ ×¢×œ×™×š", "××™×š ××©×ª××©×™× ×‘×š", "××” ××ª×” ××¦×™×¢", "××™×š ××ª×—×™×œ×™×", "×× ×™ ×¨×•×¦×” ××™×“×¢", "×× ×™ ×¨×•×¦×” ×œ×”×‘×™×Ÿ", "×‘××” ××ª×” ×¢×•×–×¨", "××” ×”×ª×¤×§×™×“ ×©×œ×š", "×›××” ×–×” ×¢×•×œ×”"],
        response: "×× ×™ ×¨×•×‘×•×˜ ×—×›× ×©× ×‘× ×” ×›×“×™ ×œ×¢×–×•×¨, ×œ×¢× ×•×ª ×¢×œ ×©××œ×•×ª, ×œ×©×•×—×—, ×œ×ª×ª ××™×“×¢, ×•×œ×”×¤×•×š ××ª ×”×ª×§×©×•×¨×ª ××™×ª×š ×œ××”×™×¨×”, × ×’×™×©×” ×•× ×¢×™××”."
      },
      {
        keywords: ["×©×œ×•×", "×”×™×™", "×”×™", "×”×™×™×™", "×©×œ×•× ×¨×‘"],
        response: "×©×œ×•× ×•×‘×¨×•×š ×”×‘×! ××™×š ××¤×©×¨ ×œ×¢×–×•×¨?"
      },
      {
        keywords: ["××” ×”×©× ×©×œ×š", "××™×š ×§×•×¨××™× ×œ×š", "××™ ××ª×”", "××™ ××ª"],
        response: "×× ×™ ×”×¨×•×‘×•×˜ ×”××“×‘×¨ ×©×œ×š. ××™×Ÿ ×œ×™ ×©× ×§×‘×•×¢ â€“ ××ª×” ×™×›×•×œ ×œ×‘×—×•×¨ ×œ×™!"
      },
      {
        keywords: ["××” ×”×©×¢×”", "×ª×’×™×“ ×œ×™ ××ª ×”×©×¢×”", "××™×–×• ×©×¢×”", "×›××” ×”×©×¢×”"],
        response: "×× ×™ ×œ× ××—×•×‘×¨ ×œ×©×¢×•×Ÿ, ××‘×œ ×”×–××Ÿ ×”×›×™ ×˜×•×‘ ×”×•× ×¢×›×©×™×•!"
      },
      {
        keywords: ["××” ××–×’ ×”××•×•×™×¨", "×”××–×’ ××•×•×™×¨", "×ª×—×–×™×ª", "×’×©×", "×©××©", "×§×¨", "×—×"],
        response: "××™×Ÿ ×œ×™ ××“ ×—×•×, ××‘×œ ×ª××™×“ × ×¢×™× ×›×©××ª×” ×¤×”!"
      },
      {
        keywords: ["××™×š ××ª×” ××¨×’×™×©", "××” ×©×œ×•××š", "××™×š ××ª ××¨×’×™×©×”", "××” ×©×œ×•××š ×”×™×•×"],
        response: "×× ×™ ××¨×’×™×© ×‘×™× ×” ××œ××›×•×ª×™×ª ××œ××” ×‘×× ×¨×’×™×” ×—×™×•×‘×™×ª!"
      },
      {
        keywords: ["×ª×¡×¤×¨ ×œ×™ ×‘×“×™×—×”", "×™×© ×œ×š ×‘×“×™×—×”", "×‘×“×™×—×”"],
        response: "×œ××” ×”×¨×•×‘×•×˜ ×œ× ×”×œ×š ×œ×‘×™×ª ×¡×¤×¨? ×›×™ ×”×•× ×›×‘×¨ ××ª×•×›× ×ª ×œ×“×¢×ª ×”×›×•×œ!"
      },
      {
        keywords: ["×œ×”×ª×¨××•×ª", "×‘×™×™", "×¡×™×•×", "×¡×’×•×¨"],
        response: "×‘×™×™ ×‘×™×™! ××—×›×” ×œ×©××•×¢ ×××š ×©×•×‘ ×‘×§×¨×•×‘!"
      },
      {
        keywords: ["×ª×•×“×”", "×ª×•×“×” ×¨×‘×”", "×ª×•×“×” ×œ×š", "×ª×•×“×” ×¢×œ ×”×¢×–×¨×”"],
        response: "×‘×©××—×”! ×ª××™×“ ×›××Ÿ ×œ×¢×–×•×¨."
      }
    ];

    function findPredefinedResponse(text) {
      const lowered = text.toLowerCase();
      for (const item of responses) {
        for (const keyword of item.keywords) {
          if (lowered.includes(keyword.toLowerCase())) {
            return item.response;
          }
        }
      }
      return null;
    }

    async function sendToWorker(text) {
      const quickReply = findPredefinedResponse(text);
      if (quickReply) {
        document.getElementById("output").textContent = quickReply;
        speak(quickReply); // ×”×©××¢×” ××™×™×“×™×ª
        return;
      }

      document.getElementById("output").textContent = "×—×•×©×‘...";
      const res = await fetch("https://lucky-grass-b400.netzach3020.workers.dev/", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ input: text })
      });

      const data = await res.json();
      const reply = data.response || "×œ× ×”×ª×§×‘×œ×” ×ª×’×•×‘×”";
      document.getElementById("output").textContent = reply;

      if (data.audio) {
        setTimeout(() => {
          const audio = new Audio(data.audio);
          audio.play();
        }, 100);
      }
    }

    function speak(text) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = "he-IL";
      window.speechSynthesis.speak(utterance);
    }

    function startListening() {
      const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      recognition.lang = "he-IL";
      recognition.interimResults = false;
      recognition.maxAlternatives = 1;

      recognition.onresult = function (event) {
        const text = event.results[0][0].transcript;
        document.getElementById("output").textContent = "×©××¢×ª: " + text;
        sendToWorker(text);
      };

      recognition.onerror = function (event) {
        document.getElementById("output").textContent = "×©×’×™××”: " + event.error;
      };

      recognition.start();
    }

  </script>

</body>
</html>
